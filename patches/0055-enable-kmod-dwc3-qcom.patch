From fa75fce4b170bba40c0f6f756bda06757c0d2377 Mon Sep 17 00:00:00 2001
From: "peter.chiu" <peter.chiu@4ipnet.com>
Date: Wed, 30 Jun 2021 17:12:59 +0800
Subject: [PATCH] enable kmod-dwc3-qcom

---
 package/kernel/linux/modules/usb.mk | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)
 mode change 100644 => 100755 package/kernel/linux/modules/usb.mk

diff --git a/package/kernel/linux/modules/usb.mk b/package/kernel/linux/modules/usb.mk
old mode 100644
new mode 100755
index a88b8df..14ddce2
--- a/package/kernel/linux/modules/usb.mk
+++ b/package/kernel/linux/modules/usb.mk
@@ -499,9 +499,10 @@ $(eval $(call KernelPackage,usb-dwc3-of-simple))
 
 define KernelPackage/usb-dwc3-qcom
   TITLE:=DWC3 Qualcomm USB driver
-  DEPENDS:=@LINUX_4_19 @(TARGET_ipq40xx||TARGET_ipq806x) +kmod-usb-dwc3
+  DEPENDS:=@!LINUX_4_19 @(TARGET_ipq40xx||TARGET_ipq806x||TARGET_ipq807x) +kmod-usb-dwc3
   KCONFIG:= CONFIG_USB_DWC3_QCOM
-  FILES:= $(LINUX_DIR)/drivers/usb/dwc3/dwc3-qcom.ko
+  FILES:= $(LINUX_DIR)/drivers/usb/dwc3/dwc3-qcom.ko \
+            $(LINUX_DIR)/drivers/usb/dwc3/dbm.ko@le4.4
   AUTOLOAD:=$(call AutoLoad,53,dwc3-qcom,1)
   $(call AddDepends/usb)
 endef
-- 
2.7.4

